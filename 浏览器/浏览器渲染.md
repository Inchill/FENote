### 浏览器渲染过程

1. 解析HTML，得到DOM tree
2. 解析CSS，得到CSSOM tree
3. 将两者整合成渲染数render tree
4. 布局，根据render tree计算每个节点的位置、大小等信息
5. 绘制，显卡根据计算好的信息绘制到屏幕上

- 1、2、3非常快，但是4、5比较耗时，涉及到重排(回流)和重绘。
- 重排一定会发生重绘，但重绘不一定发生重排。
- display: none会导致重排和重绘，visibility: hidden会发生重绘

DOM树与渲染数区别：

- DOM树与HTML标签一一对应，包括head和空元素
- 渲染树不包括head和空元素，大段文本的每一行都是一个独立节点，每一个节点都有对应的CSS属性

### CSS会阻塞HTML解析吗？

- css会阻塞HTML渲染，不会阻塞解析

### 如何最小化重排和重绘？

- 需要完成复杂的DOM操作时，可以先display: none，操作完成后再显示
- 创建多个DOM元素时，使用DocumentFragment创建完后一次性加入document，或使用字符串拼接方式.

### 浏览器如何解析css选择器？

- 浏览器会从右向左解析css选择器。如果从左向右，遇到不符合条件的节点时为查询失败，再回溯重新查找。因此从左向右的匹配规则性能都浪费在了失败的查询上面。

### DOM tree是如何构建的？

1. **转码**：浏览器将接收到的二进制数据按照指定编码格式转换成HTML字符串。
2. **生成Tokens**：之后开始parser，浏览器会将HTML字符串解析成Tokens。
3. **构建Nodes**：对Node添加特定的属性，通过指针确定Node的父、子、兄弟关系和所属treeScope。
4. **生成DOM tree**：通过Node包含的指针确定的关系构建DOM tree。